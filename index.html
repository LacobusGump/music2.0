<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GUMP - Spatial Motion AI Music</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at 40% 60%, #0a0a0a 0%, #1a1a2e 40%, #16213e 100%);
      color: #00ffaa;
      overflow: hidden;
      touch-action: none;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 1s ease;
    }
    body.transcendent {
      background: radial-gradient(circle at 60% 40%, #0a0a1a 0%, #1a0a2e 30%, #2a1a3e 60%, #3a2a4e 100%);
      color: #ff88cc;
    }
    .app {
      width: 100%;
      max-width: 400px;
      padding: 20px;
      text-align: center;
    }
    .logo {
      font-size: clamp(3rem, 12vw, 6rem);
      font-weight: 900;
      background: linear-gradient(45deg, #00ffaa, #ff6b6b, #4ecdc4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 0.5rem;
      animation: pulse 3s ease-in-out infinite;
      transition: all 1s ease;
    }
    .logo.transcendent {
      background: linear-gradient(45deg, #ff88cc, #88aaff, #ccaa88, #ffcc88);
      animation: ascend 4s ease-in-out infinite;
      filter: drop-shadow(0 0 20px rgba(255,136,204,0.3));
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    @keyframes ascend {
      0%, 100% { transform: scale(1) translateY(0); }
      50% { transform: scale(1.12) translateY(-8px); }
    }
    .tagline {
      font-size: clamp(1rem, 4vw, 1.2rem);
      opacity: 0.8;
      margin-bottom: 3rem;
      font-weight: 300;
      transition: all 1s ease;
    }
    .tagline.transcendent {
      color: #ff88cc;
      opacity: 0.9;
      animation: breathe 3s ease-in-out infinite;
    }
    @keyframes breathe {
      0%, 100% { opacity: 0.9; }
      50% { opacity: 1; }
    }
    .start-btn {
      padding: 20px 40px;
      background: linear-gradient(45deg, #00ffaa, #4ecdc4);
      color: #000;
      border: none;
      border-radius: 30px;
      font-size: 1.2rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 10px 30px rgba(0,255,170,0.3);
      margin-bottom: 2rem;
    }
    .start-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 40px rgba(0,255,170,0.5);
    }
    .spatial-viz {
      width: 100%;
      height: 200px;
      border: 2px solid rgba(0,255,170,0.2);
      border-radius: 20px;
      position: relative;
      overflow: hidden;
      background: rgba(0,255,170,0.03);
      margin-bottom: 2rem;
      transition: all 1s ease;
    }
    .spatial-viz.transcendent {
      border-color: rgba(255,136,204,0.4);
      background: rgba(255,136,204,0.08);
      box-shadow: inset 0 0 30px rgba(255,136,204,0.1);
    }
    .orb {
      position: absolute;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: radial-gradient(circle, #00ffaa, transparent);
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      transition: all 0.2s ease;
      box-shadow: 0 0 30px rgba(0,255,170,0.5);
    }
    .orb.transcendent {
      background: radial-gradient(circle, #ff88cc 0%, #88aaff 50%, transparent 100%);
      box-shadow: 0 0 60px rgba(255,136,204,0.6), 0 0 120px rgba(136,170,255,0.3);
      animation: transcendentFloat 5s ease-in-out infinite;
    }
    @keyframes transcendentFloat {
      0%, 100% { transform: translate(-50%, -50%) scale(1); }
      50% { transform: translate(-48%, -52%) scale(1.2); }
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-bottom: 2rem;
    }
    .stat {
      background: rgba(0,255,170,0.1);
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(0,255,170,0.2);
      transition: all 1s ease;
    }
    .stat.transcendent {
      background: rgba(255,136,204,0.15);
      border-color: rgba(255,136,204,0.3);
    }
    .stat-value {
      font-size: 1.3rem;
      font-weight: 700;
      color: #00ffaa;
      transition: all 1s ease;
    }
    .stat-value.transcendent {
      color: #ff88cc;
    }
    .stat-label {
      font-size: 0.7rem;
      opacity: 0.7;
      margin-top: 3px;
    }
    .status {
      font-size: 0.9rem;
      color: #4ecdc4;
      opacity: 0.8;
      animation: statusBreathe 2s ease-in-out infinite;
      transition: all 1s ease;
    }
    .status.transcendent {
      color: #ff88cc;
      animation: transcendentBreathe 3s ease-in-out infinite;
    }
    @keyframes statusBreathe {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; }
    }
    @keyframes transcendentBreathe {
      0%, 100% { opacity: 0.9; }
      50% { opacity: 1; transform: scale(1.02); }
    }
    .hidden { display: none !important; }
    .error {
      background: rgba(255,107,107,0.1);
      border: 1px solid rgba(255,107,107,0.3);
      border-radius: 15px;
      padding: 20px;
      color: #ff6b6b;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="neural-bg" id="neuralBg"></div>
  <div class="void-layer" id="voidLayer"></div>
  <div class="particles" id="particles"></div>

  <div class="app">
    <div class="logo" id="logo">GUMP</div>
    <div class="tagline" id="tagline">Grand Unified Music Platform</div>
    <div class="weather-status" id="weatherStatus">üå§Ô∏è Loading weather‚Ä¶</div>
    <button class="start-btn" id="startBtn">üéµ Start Spatial Audio</button>

    <div class="spatial-viz hidden" id="spatialViz">
      <div class="orb" id="orb"></div>
    </div>

    <div class="stats hidden" id="stats">
      <div class="stat"><div class="stat-value" id="motionValue">0</div><div class="stat-label">Motion</div></div>
      <div class="stat"><div class="stat-value" id="bpmValue">95</div><div class="stat-label">BPM</div></div>
      <div class="stat"><div class="stat-value" id="grooveValue">CHILL</div><div class="stat-label">State</div></div>
    </div>

    <div class="status hidden" id="status">üéµ Flowing with your vibe...</div>
    <div class="error hidden" id="error"></div>
  </div>

  <script>
    class SpatialAI {
      constructor() {
        this.ctx = null;
        this.motion = 0;
        this.bpm = 95;
        this.pos = { x: 50, y: 50 };
        this.last = { x: 0, y: 0, z: 0 };
        this.active = false;
        this.step = 0;
        this.state = 'CHILL';
        this.transcendent = false;
        this.transcendentIntensity = 0;
        this.lastMotionTime = Date.now();
        this.heavenOscillators = [];
        this.reverb = null;
        this.scale = [261.63,293.66,329.63,349.23,392.00,440.00,493.88,523.25];
        this.chords = [[0,2,4,6],[5,0,2,4],[3,5,0,2],[4,6,1,3]];
        this.currentChord = 0;
        this.patterns = { kick:[1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0], snare:[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0] };
        this.weather = { temp:20, condition:'clear' };
        this.init();
      }
      init() {
        document.getElementById('startBtn').onclick = () => this.start();
        this.fetchWeather();
      }
      async fetchWeather() {
        try {
          const pos = await new Promise((res, rej) => navigator.geolocation.getCurrentPosition(res, rej));
          const resp = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${pos.coords.latitude}&lon=${pos.coords.longitude}&units=metric&appid=789e7d7e2ab3c81f42ca93d449c715c6`);
          if (!resp.ok) throw new Error('Weather API error');
          const data = await resp.json();
          let mode='CLEAR';
          const cond = data.weather[0].main.toLowerCase();
          if(cond.includes('rain')||cond.includes('drizzle')) mode='RAIN';
          else if(cond.includes('thunder')||cond.includes('storm')) mode='STORM';
          else if(cond.includes('snow')) mode='SNOW';
          document.getElementById('weatherStatus').textContent=`${data.name}: ${Math.round(data.main.temp)}¬∞C`;
          this.weather={ temp:data.main.temp, condition:mode.toLowerCase()};
        } catch(e) {
          document.getElementById('weatherStatus').textContent='Weather unavailable';
        }
      }
      async start() {
        try {
          this.ctx=new(window.AudioContext||window.webkitAudioContext)(); if(this.ctx.state==='suspended')await this.ctx.resume(); this.createReverb();
          document.getElementById('startBtn').classList.add('hidden'); ['spatialViz','stats','status'].forEach(id=>document.getElementById(id).classList.remove('hidden'));
          this.active=true; this.startSensors(); this.startGroove(); this.animate(); this.monitorTranscendence();
        } catch(e) { this.showError('Motion sensors unavailable. Please use a mobile device.'); }
      }
      createReverb() { if(!this.ctx)return; this.reverb=this.ctx.createConvolver(); const buf=this.ctx.createBuffer(2,this.ctx.sampleRate*2,this.ctx.sampleRate); for(let c=0;c<2;c++){const d=buf.getChannelData(c);for(let i=0;i<d.length;i++)d[i]=(Math.random()*2-1)*Math.pow(1-i/d.length,2);} this.reverb.buffer=buf; this.reverb.connect(this.ctx.destination); }
      startSensors() { window.addEventListener('devicemotion',e=>{ if(!this.active)return; const a=e.accelerationIncludingGravity; if(!a||a.x===null)return; const dx=Math.abs(a.x-this.last.x),dy=Math.abs(a.y-this.last.y),dz=Math.abs(a.z-this.last.z); this.motion=Math.min(100,Math.sqrt(dx*dx+dy*dy+dz*dz)*15); this.last={x:a.x,y:a.y,z:a.z}; if(this.motion>8)this.lastMotionTime=Date.now(); this.pos.x=Math.max(5,Math.min(95,50+a.x*3)); this.pos.y=Math.max(5,Math.min(95,50+a.y*3)); this.updateState(); }); }
      monitorTranscendence(){const chk=()=>{if(!this.active)return; const st=Date.now()-this.lastMotionTime,go=st>1500; if(go&&!this.transcendent)this.enterTranscendence(); else if(!go&&this.transcendent)this.exitTranscendence(); if(this.transcendent){this.transcendentIntensity=Math.min(1,(st-1500)/4000); this.deepenVoid();} setTimeout(chk,100);} ; chk(); }
      enterTranscendence(){this.transcendent=true;this.state='HEAVEN'; ['logo','tagline','spatialViz','orb','motionValue','bpmValue','grooveValue','status'].forEach(id=>document.getElementById(id).classList.add('transcendent')); document.body.classList.add('transcendent'); this.createParticles(); this.startHeavenLayers();}
      exitTranscendence(){this.transcendent=false;this.state='CHILL'; ['logo','tagline','spatialViz','orb','motionValue','bpmValue','grooveValue','status'].forEach(id=>document.getElementById(id).classList.remove('transcendent')); document.body.classList.remove('transcendent'); this.clearParticles(); this.stopHeavenLayers(); }
      createParticles(){const c=document.getElementById('particles');c.classList.add('active'); for(let i=0;i<20;i++){const p=document.createElement('div');p.className='particle';p.style.left=Math.random()*100+'%';p.style.animationDelay=Math.random()*6+'s';c.appendChild(p);} }
      clearParticles(){const c=document.getElementById('particles');c.classList.remove('active'); setTimeout(()=>c.innerHTML='',2000); }
      deepenVoid(){const i=this.transcendentIntensity; if(i>0.3)document.body.style.background='radial-gradient(circle at 60% 40%,#050510 0%,#0a0a1e 20%,#1a0a2e 40%,#2a1a3e 70%,#1a0a2e 100%)'; if(i>0.6)document.body.style.background='radial-gradient(circle at 60% 40%,#020208 0%,#05050f 15%,#0a0a1e 30%,#1a0a2e 50%,#0a0a1e 80%,#020208 100%)'; if(i>0.4&&Math.random()<0.005)this.voidWhisper(); if(i>0.7&&Math.random()<0.003)this.voidBell(); }
      voidWhisper(){const o=this.ctx.createOscillator(),g=this.ctx.createGain(),f=this.ctx.createBiquadFilter(); o.type='triangle';o.frequency.value=150+Math.random()*200; f.type='bandpass';f.frequency.value=300;f.Q.value=8; g.gain.setValueAtTime(0,this.ctx.currentTime);g.gain.linearRampToValueAtTime(0.03,this.ctx.currentTime+1);g.gain.exponentialRampToValueAtTime(0.001,this.ctx.currentTime+6); o.connect(f).connect(g);g.connect(this.reverb);o.start();o.stop(this.ctx.currentTime+6);} 
      voidBell(){const freqs=[174,207,261,311],freq=freqs[Math.floor(Math.random()*4)]; const o=this.ctx.createOscillator(),g=this.ctx.createGain(); o.type='sine';o.frequency.value=freq; g.gain.setValueAtTime(0,this.ctx.currentTime);g.gain.linearRampToValueAtTime(0.08,this.ctx.currentTime+0.3);g.gain.exponentialRampToValueAtTime(0.001,this.ctx.currentTime+8); o.connect(g);g.connect(this.reverb);o.start();o.stop(this.ctx.currentTime+8);} 
      startHeavenLayers(){const chord=this.chords[this.currentChord]; chord.forEach(n=>{const o=this.ctx.createOscillator(),g=this.ctx.createGain(),f=this.ctx.createBiquadFilter(); o.type='sine';o.frequency.value=this.scale[n]*0.5; f.type='lowpass';f.frequency.value=400;f.Q.value=2; g.gain.setValueAtTime(0,this.ctx.currentTime);g.gain.linearRampToValueAtTime(0.12,this.ctx.currentTime+3); o.connect(f).connect(g);g.connect(this.reverb);o.start(); this.heavenOscillators.push({o,g});}); setTimeout(()=>{if(!this.transcendent)return; chord.forEach(n=>{const o=this.ctx.createOscillator(),g=this.ctx.createGain(); o.type='triangle';o.frequency.value=this.scale[n]*1.5; g.gain.setValueAtTime(0,this.ctx.currentTime);g.gain.linearRampToValueAtTime(0.06,this.ctx.currentTime+2); o.connect(g);g.connect(this.reverb);o.start(); this.heavenOscillators.push({o,g});});},2000);} 
      stopHeavenLayers(){this.heavenOscillators.forEach(({o,g})=>{try{g.gain.exponentialRampToValueAtTime(0.001,this.ctx.currentTime+2);o.stop(this.ctx.currentTime+2);}catch{} });this.heavenOscillators=[];} 
      updateState(){if(this.transcendent){const s=['HEAVEN','VOID','ETHEREAL','INFINITE'],idx=Math.floor(this.transcendentIntensity*4);this.state=s[Math.min(idx,3)];this.bpm=60+this.transcendentIntensity*30;return;} if(this.motion<15){this.state='CHILL';this.bpm=85+this.motion*0.4+this.adjustForWeather();}else if(this.motion<45){this.state='FLOW';this.bpm=95+this.motion*0.3+this.adjustForWeather();}else{this.state='ENERGY';this.bpm=110+this.motion*0.2+this.adjustForWeather();}} 
      adjustForWeather(){let adj=0; if(this.weather.temp<10)adj-=5; if(this.weather.temp>30)adj+=10; if(this.weather.condition==='rain')adj-=3; if(this.weather.condition==='storm')adj+=5;return Math.max(-10,Math.min(10,adj));} 
      startGroove(){const tick=()=>{if(!this.active)return; if(this.transcendent){if(this.step%8===0)this.etherealKick();if(this.step%16===8&&this.transcendentIntensity>0.2)this.heavenSnare();if(this.step%32===16&&this.transcendentIntensity>0.5)this.voidPulse();}else{if(this.patterns.kick[this.step])this.kick();if(this.patterns.snare[this.step]&&this.motion>10)this.snare();if(this.step%8===0)this.bass();}this.step=(this.step+1)%16; if(this.step===0)this.currentChord=(this.currentChord+1)%this.chords.length; setTimeout(tick,60000/this.bpm/4);};tick();} 
      kick(){const o=this.ctx.createOscillator(),g=this.ctx.createGain();o.frequency.setValueAtTime(60,this.ctx.currentTime);o.frequency.exponentialRampToValueAtTime(30,this.ctx.currentTime+0.1);g.gain.setValueAtTime(0.8,this.ctx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,this.ctx.currentTime+0.3);o.connect(g).connect(this.ctx.destination);o.start();o.stop(this.ctx.currentTime+0.3);} 
      snare(){const o=this.ctx.createOscillator(),g=this.ctx.createGain();o.type='square';o.frequency.value=200;g.gain.setValueAtTime(0.3,this.ctx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,this.ctx.currentTime+0.1);o.connect(g).connect(this.ctx.destination);o.start();o.stop(this.ctx.currentTime+0.1);} 
      etherealKick(){const o=this.ctx.createOscillator(),g=this.ctx.createGain();o.type='sine';o.frequency.setValueAtTime(45,this.ctx.currentTime);o.frequency.exponentialRampToValueAtTime(25,this.ctx.currentTime+0.4);g.gain.setValueAtTime(0.4,this.ctx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,this.ctx.currentTime+0.8);o.connect(g);g.connect(this.reverb);o.start();o.stop(this.ctx.currentTime+0.8);} 
      heavenSnare(){const o=this.ctx.createOscillator(),g=this.ctx.createGain();o.type='triangle';o.frequency.value=400;g.gain.setValueAtTime(0.15,this.ctx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,this.ctx.currentTime+0.6);o.connect(g);g.connect(this.reverb);o.start();o.stop(this.ctx.currentTime+0.6);} 
      bass(){const o=this.ctx.createOscillator(),g=this.ctx.createGain();o.frequency.value=this.scale[this.chords[this.currentChord][0]]*0.5;g.gain.setValueAtTime(0.2,this.ctx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,this.ctx.currentTime+0.4);o.connect(g).connect(this.ctx.destination);o.start();o.stop(this.ctx.currentTime+0.4);} 
      voidPulse(){const o=this.ctx.createOscillator(),g=this.ctx.createGain(),f=this.ctx.createBiquadFilter();o.type='sawtooth';o.frequency.value=25;f.type='lowpass';f.frequency.value=60;f.Q.value=4;g.gain.setValueAtTime(0.6,this.ctx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,this.ctx.currentTime+1.2);o.connect(f).connect(g);g.connect(this.reverb);o.start();o.stop(this.ctx.currentTime+1.2);} 
      animate(){const upd=()=>{if(!this.active)return;document.getElementById('motionValue').textContent=Math.round(this.motion);document.getElementById('bpmValue').textContent=Math.round(this.bpm);document.getElementById('grooveValue').textContent=this.state;const orb=document.getElementById('orb');orb.style.left=this.pos.x+'%';orb.style.top=this.pos.y+'%';requestAnimationFrame(upd);};upd();} 
      showError(msg){const e=document.getElementById('error');e.textContent=msg;e.classList.remove('hidden');}
    }
    window.addEventListener('DOMContentLoaded',()=>new SpatialAI());
  </script>
</body>
</html>
